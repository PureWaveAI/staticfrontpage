[phases.setup]
# Install nginx from Nixpkgs
nixPkgs = ['nginx']

[phases.build]
# Copy the static site (exactly the contents of ./app) into nginx's web root
# and use our custom nginx config
cmds = [
  'mkdir -p /var/www/html',
  'cp -r app/. /var/www/html/',
  'mkdir -p /etc/nginx'
  'cp -r docker/nginx.conf /etc/nginx/nginx.conf'
]

[start]
# Ensure log directory exists, then run nginx in the foreground
cmd = 'mkdir -p /var/log/nginx && nginx -c /etc/nginx/nginx.conf -g "daemon off;"'